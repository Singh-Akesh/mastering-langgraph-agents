from qdrant_client import QdrantClient
from qdrant_client.models import VectorParams

COLLECTION_NAME = "emails"
VECTOR_SIZE = 768  # dimension of your embeddings
DISTANCE = "Cosine"  # or "Dot", "Euclid"

client = QdrantClient(url="http://localhost:6333")

def create_collection():
    # Create collection if it doesn't exist
    if COLLECTION_NAME in [col.name for col in client.get_collections().collections]:
        print(f"Collection '{COLLECTION_NAME}' already exists.")
        return
    client.create_collection(
        collection_name=COLLECTION_NAME,
        vectors_config=VectorParams(size=VECTOR_SIZE, distance=DISTANCE),
    )

def query_emails():
    search_result = client.query_points(
        collection_name=COLLECTION_NAME,
        query=[0.020131027, 0.010372876, -0.13360618, -0.07201618, 0.022628536, 0.01693507, 0.04604396, -0.031504728, 0.00094972283, -0.019867824, -0.022840988, 0.059095357, 0.10318325, 0.034202494, -0.0007173136, -0.04085149, 0.06298863, -0.041381225, -0.078959405, 0.036631558, -0.018949673, -0.017036784, -0.059375677, 0.012036367, 0.0687794, -0.00029690404, -0.020525375, 0.031260874, -0.05650086, -0.0056513087, 0.070423745, -0.0029452804, -0.055307403, -0.043753702, -0.07400432, 0.012111659, -0.0048552006, -0.020948816, -0.013267249, 0.00044761127, 0.053183313, -0.0081299655, 0.00036351118, -0.028579226, 0.043590624, -0.009028567, 0.034316245, -0.0112275565, 0.05242316, -0.024784936, 0.008285597, -0.016164748, -0.007985929, -0.051925063, 0.03143877, 0.026385557, 0.007864096, -0.049183115, 0.032961663, 0.014263844, 0.15322796, 0.063173324, -0.05366426, 0.044956435, 0.03095522, -0.021154929, -0.0145314215, 0.032878816, -0.014154285, -0.014172856, 0.077300966, 0.049808886, 0.010701264, 0.06267622, -0.0035372088, -0.016777812, 0.0027650087, -0.058094386, -0.03162963, 0.018544575, 0.041508257, -0.0040878044, 0.014621427, -0.018703502, 0.07359442, -0.02399682, -0.02512211, 0.016782295, -0.03459417, 0.06894321, 0.047074117, 0.016178893, -0.023388108, 0.020799736, -0.052643873, 0.02378446, -0.025331806, -0.00069045, -0.049696334, -0.049104635, -0.06099159, -0.07972822, 0.05576748, 0.02523666, -0.0058426494, 0.037596118, -0.01630498, -0.021474905, -0.038808074, -0.057090983, -0.021417558, 0.012833231, -0.061262283, -0.0037565946, 0.056039188, 0.0053366735, 0.028723562, -0.042809088, 0.017326338, 0.02392099, -0.026743142, -0.040044818, -0.026228607, 0.04117051, 0.049230594, 0.009422121, -0.02052158, -0.009389783, 0.010548206, -0.045500636, -0.048341434, -0.014645059, -0.035219427, 0.009337494, -0.0022432965, 0.024857586, -0.031729206, 0.018039314, 0.053692468, 0.033060648, 0.057222217, -0.018918702, -0.015946094, -0.026262429, 0.04749407, 0.0052462076, 0.024580441, 0.015404932, -0.026448611, 0.023623368, -0.013333754, 0.039286867, -0.035495274, 0.040928483, 0.0396613, -0.0708427, 0.0029210916, -0.028330073, 0.014377355, 0.03326304, 0.036316335, 0.03205391, -0.036949098, 0.055698004, 0.0007006275, -0.031696353, -0.0020514338, 0.026331808, 0.018002706, 0.0706329, -0.039130785, -0.019799368, 0.011199252, -0.032072566, 0.015898062, -0.016636817, -0.0046038087, -0.050881494, 0.03215296, -0.023372116, 0.009278806, -0.04996533, 0.026864532, 0.014800239, -0.0076831896, -0.07638936, 0.003861763, 0.0055323597, 0.010484911, -0.045147162, -0.021056868, -0.004761884, -0.048882194, -0.044476993, -0.069784515, -0.04642207, 0.037205532, 0.019627262, 0.02363933, 0.0016550068, -0.02220086, 0.024593374, -0.02592534, 0.034976665, -0.01992449, 0.021769196, 0.0019732085, -0.011147797, -0.00838617, 0.028770585, 0.014829455, 0.012722585, -0.023206253, 0.0010931416, 0.057117507, -0.008235888, -0.0018864628, -0.012353986, -0.011731159, 0.043163653, 0.0042997203, -0.01088265, 0.0103473, -0.046575986, 0.009685624, 0.0027253693, 0.010170706, -0.027994003, -0.078926355, -0.028971437, -0.03522013, -0.05517607, -0.011697943, 0.051785424, 0.029360011, 0.07173599, 0.003952112, 0.026977489, -0.0053431382, -0.030561095, -0.008086738, 0.060212284, -0.023964897, -0.0005399481, -0.032751713, 0.018256739, 0.011469845, -0.033742443, 0.015754012, 0.09203708, 0.036070127, 0.007192523, 0.032398492, 0.048625056, 0.0405065, -0.0824421, -0.02982217, -0.0007698659, -0.03075632, -0.057333928, 0.06968755, -0.05283067, -0.0019718949, -0.027261201, -0.007634736, -0.077352054, 0.0141810775, 0.0015291437, 0.0042023254, -0.025314106, 0.040839866, 0.0040498343, -0.011761932, 0.019951994, -0.05044867, 0.033784404, 0.010668334, -0.00553837, -0.034727294, 0.03387954, -0.08700057, -0.06266455, -0.03325697, -0.0030150546, -0.0033076857, -0.026756886, -0.022073682, 0.04113, 0.014362154, -0.023617955, 0.028980799, 0.040362995, -0.00011565145, 0.044191655, 0.078336194, 0.04095303, 0.077331185, -0.00062633504, 0.017808173, -0.03694256, 0.019952653, 0.040919248, 0.033032093, 0.049479682, -0.011450594, -0.018327108, 0.04018438, 0.010057345, 0.037145216, -0.008145477, -0.023108825, -0.00060480676, 0.020522976, 0.02740702, -0.057566196, 0.039612792, -0.009551018, 0.024669148, 0.0526661, 0.018212263, -0.0139484815, -0.009358113, -0.02587105, -0.030792806, -0.011643643, 0.097836465, -0.06706232, 0.03416394, 0.030121947, -0.01012508, -0.019941546, 0.002576462, -0.016743457, -0.07972623, -0.027011832, 0.043317325, -0.030731916, 0.048149392, 0.011299167, 0.06494748, 0.048285045, 0.0067888964, -0.017241463, -0.054002706, 0.04008977, -0.022131927, -0.019960325, -0.02030975, 0.04642674, 0.053979144, -0.027244212, 0.034166384, -0.013052662, -0.06265345, 0.018350264, 0.024019571, 0.008323586, 0.0068884348, 0.03199161, -0.031866312, 0.008293825, 0.0046245945, 0.016062789, 0.013266437, -0.015175489, 0.013240163, 0.06526457, -0.005091084, 0.050289657, 0.010064838, 0.013763108, -0.03297382, -0.019553026, 0.066453256, 0.020532148, -0.019195357, -0.0796231, -0.052717064, -2.174036e-05, 0.031295355, 0.060656134, -0.021267215, -0.008085597, 0.027265534, 0.0605089, 0.020338846, 0.009112851, -0.027457185, 0.0069861715, 0.0393403, -0.0021713064, -0.026926935, -0.019936657, 0.0062895655, 0.038814876, 0.034399938, 0.0062691565, 0.022900727, 0.0020562396, 0.03524426, -0.019484568, -0.003665346, 0.02259604, 0.0010761265, -0.03614624, 0.059991132, -0.02340406, -0.06521768, 0.025864586, -0.046721134, 0.021373764, 0.0017225749, -0.047225285, -0.019478427, -0.007567305, -0.006471158, 0.059834335, 0.029579602, -0.021535931, -0.04547102, 0.048610307, 0.0019051245, -0.030765861, -0.00946536, 0.037260573, 0.029274916, 0.009908113, 0.018348057, -0.0044693537, -0.030263245, -0.018162768, 0.032567587, 0.009150242, -0.01728787, -0.014301269, 0.01728073, 0.057587713, 0.023503456, 0.04175527, 0.024599947, 0.031662047, -0.02867399, 0.024957394, -0.011080913, 0.01968188, 0.088755175, 0.048318896, -0.027345803, -0.015130927, 0.0326332, 0.009346567, 0.003266869, 0.030133529, 0.038504772, 0.075005226, -0.026808117, -0.030935083, -0.01978252, -0.0018713819, 0.056419384, -0.0031942942, 0.0067749536, -0.014930496, 0.029158557, -0.02181965, 0.00055098376, 0.018923493, -0.005474356, 0.0247251, 0.04599072, -0.036260698, -0.019249229, 0.052812804, -0.041838672, 0.016181894, 0.060753345, -0.058665562, -0.0021758524, 0.01741019, 0.052911837, 0.0072012683, 0.0061624525, -0.013258462, -0.07314511, 0.033814643, 0.04291289, 0.014891163, 0.011174896, 0.028644145, -0.03380204, 0.020946223, -0.030843595, 0.006014297, -0.023567842, 0.011373402, -0.0035798142, -0.02707522, 0.018380772, 0.031636804, 0.0057892557, 0.025565134, 0.03409239, -0.026692139, 0.004946961, -0.004165432, -0.008498034, -0.017434815, -0.047737516, -0.051074527, 0.0030318305, -0.04093759, -0.0069974293, 0.026753772, 0.04461944, 0.06095592, -0.038230497, 0.046373885, -0.011389333, -0.062492047, 0.053306445, -0.023879405, -0.037074942, 0.0022334051, -0.0032661157, -0.07048345, 0.0034809783, 0.0014098008, -0.06589062, -0.0026276428, -0.0036651166, -0.040426232, 0.069390334, 0.0015331727, -0.011874157, 0.007717604, -0.02595196, -0.0069516427, 0.03076573, 0.040983714, -0.014668103, 0.054144785, -0.005440826, 0.013422692, -0.029677968, -0.0051733884, -0.016584806, -0.020913022, -0.031221477, -0.0042999876, -0.024455022, 0.008540931, -0.03549485, -0.024331616, -0.00094326737, 0.03685979, -0.024375474, -0.016182939, -0.033830836, -0.016256025, -0.041632492, 0.017298803, 0.010714489, 0.059883818, 0.023897298, -0.03267305, -0.009997721, 0.019002568, -0.048988223, 0.017854225, 0.02350121, 0.0007030646, -0.086446546, -0.050219286, -0.011346253, 1.8762088e-05, 0.0060430756, 0.003992849, -0.002041009, -0.0652731, -0.06407107, 0.007013737, -0.02835774, 0.035265103, 0.04827742, -0.036878813, -0.015528309, -0.06484803, 0.009273218, 0.06559551, -0.04596245, -0.027364582, 0.014381917, 0.022950897, 0.03118314, -0.030688222, -0.005431177, 0.02949409, 0.0064784125, -0.025267439, 0.003774521, -0.025835415, -0.0056286473, 0.06782147, -0.034351956, 0.005516938, 0.016746325, 0.005831202, 0.032434493, 0.0038713969, -0.03417301, -0.004243251, -0.013635812, 0.025239475, 0.054719, 0.052631173, -0.026554085, 0.04350309, -0.04071929, -0.017424464, -0.040026132, -0.0052653737, -0.011545098, 0.048929792, -0.041163348, -0.008134327, 0.010487659, -0.0483746, -0.005742145, -0.034770474, 0.03553154, -0.03598696, 0.01110002, -0.099808685, -0.041619744, -0.017328633, 0.0042612064, 0.01728042, 0.044343058, -0.013238181, 0.05134173, -0.0016681037, -0.03377848, -0.012538056, 0.024282249, -0.01976191, -0.0117817, 0.052517388, 0.02610253, 0.021933785, -0.046089396, 0.06950286, 0.06726417, 0.014791998, 0.008798283, 0.0030073614, -0.012945257, 0.048318416, -0.017792927, 0.031576093, -0.044494, -0.035942562, -0.04390795, -0.00464304, -0.00031652284, 0.0137181915, -0.018461647, -0.014310002, -0.0026480756, -0.095018625, -0.011269596, 0.04554364, 0.0445887, 0.05998338, -0.02513348, -0.005144281, 0.03283614, 0.049485266, 0.015776774, -0.024506776, -0.047674023, -0.02773315, 0.03301834, -0.008980379, 0.026862469, -0.005558757, -0.050773274, 0.03676217, -0.029030943, -0.015856357, -0.018858375, -0.015924348, 0.0047213105, -0.03845371, -0.030306, 0.021028168, -0.021058032, -0.008094709, -0.0396529, -0.0019532158, 0.075085804, -0.023515044, 0.04767923, 0.0045135804, 0.019106468, -0.030511238, -0.054645456, -0.01256636, -0.039320286, -0.013403735, -0.034787875, 0.021941176, 0.00014823166, -0.027296554, 0.06773892, 0.08703583, 0.04369908, -0.0074356087, -0.02857786, -0.04885541, -0.002312406, 0.08600328, 0.030307354, -0.085395575, -0.0560461, -0.025382979, -0.0018802114, 0.051345803, -0.0163692, 0.012684088, -0.02847211, 0.054542676, 0.0044556214, -0.033524252, 0.041997828, -0.009143152, 0.017720165, -0.10127518, -0.02135461, -0.024040766, 0.002346764, -0.023965513, 0.03911408, 0.010776115, 0.0026315833, -0.040348522, -0.04654346, -0.07370644, 0.024652133, 0.041210033, -0.042223703, -0.005752436, -0.022606377, -0.041445397, 0.016097121, -0.0024194643, -0.0048418352, -0.005025405, -4.095951e-06, 0.08658413, -0.031545613, 0.0036690705, -0.047518432, 0.027631694, 0.037246168, -0.0037485685, -0.05634903, -0.018069804, -0.017859716],
        with_payload=True,
        limit=3
    ).points
    print(search_result)

def count_emails():
    # Get exact number of points
    count_result = client.count(collection_name=COLLECTION_NAME, exact=True)
    exact_point_count = count_result.count
    print(f"Exact number of points: {exact_point_count}")

def retrieve_point():
    point_data = client.retrieve(
        collection_name="emails",
        ids=[1113000, 162000],
        with_payload=True,
        with_vectors=False,
    )
    print(point_data)

if __name__ == '__main__':
    # count_emails()
    # query_emails()
    retrieve_point()
